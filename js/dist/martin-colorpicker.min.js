function mouseup(){MOUSE_DOWN=!1}function mousedown(){MOUSE_DOWN=!0}function distance(r,t){var o=r[0]-t[0],e=r[1]-t[1];return Math.sqrt(o*o+e*e)}function xVal(r,t){return(255-r)*(1-INDICATOR_WIDTH/(WIDTH+INDICATOR_WIDTH)-t)+r}function yVal(r){return 255*r}function clamp(r,t,o){return r>o?o:t>r?t:r}function valFromY(r,t){var o=Math.cos(2*Math.PI*(r+t))+.5;return o=clamp(o,0,1),255*o}function coercePixel(r,t,o,e){return t/=WIDTH-1,e.r=xVal(r.r,t),e.g=xVal(r.g,t),e.b=xVal(r.b,t),o/=HEIGHT-1,e.r-=yVal(o),e.g-=yVal(o),e.b-=yVal(o),e.r=clamp(e.r,0,255),e.g=clamp(e.g,0,255),e.b=clamp(e.b,0,255),e}function makePicker(r){var t=Martin();t.width(WIDTH+INDICATOR_WIDTH).height(HEIGHT),t.newLayer(),t.background("#fff");var o=t.colorpicker({r:255,g:0,b:0});r.value=getHexValue({r:valFromY(0,0),g:valFromY(0,1/3),b:valFromY(0,2/3)},WIDTH,0),t.indicator(),t.newLayer();var e=t.rect({color:"#666",x:WIDTH+1,y:1,height:4,width:INDICATOR_WIDTH-2,stroke:"#fff",strokeWidth:2}),a=t.circle({radius:4,color:"#666",stroke:"#fff",strokeWidth:2,x:WIDTH,y:0});return t.mousemove(function(t){var n,i=t.x,c=t.y;MOUSE_DOWN&&(i>WIDTH&&Math.abs(c-e.data.y-.5*e.data.height)<20?(c/=HEIGHT-1,n={r:valFromY(c,0),g:valFromY(c,1/3),b:valFromY(c,2/3)},e.data.y=t.y-2,o.data=n):WIDTH>=i&&(c/=HEIGHT-1,n={r:valFromY(c,0),g:valFromY(c,1/3),b:valFromY(c,2/3)},a.data.x=t.x,a.data.y=t.y),n&&(r.value=getHexValue(n,a.data.x,a.data.y)))}),t.on("mousedown",mousedown),t.on("mouseup mouseout mouseleave",mouseup),t}function getHexValue(r,t,o){var e=coercePixel(r,t,o,{});return e.r=zFill(Math.round(e.r).toString(16),2),e.g=zFill(Math.round(e.g).toString(16),2),e.b=zFill(Math.round(e.b).toString(16),2),"#"+e.r.toString(16)+e.g.toString(16)+e.b.toString(16)}function zFill(r,t){for(;r.length<t;)r="0"+r;return r}function showPicker(r){var t=makePicker(r);t.canvas.style.cursor="pointer",r.parentNode.insertBefore(t.canvas,r)}function loadPicker(){var r=document.getElementsByTagName("input");[].forEach.call(r,function(r){"martin-colorpicker"===r.getAttribute("data-type")&&showPicker(r)})}var WIDTH=200,HEIGHT=200,INDICATOR_WIDTH=20,MOUSE_DOWN=!1;Martin.registerEffect("colorpicker",function(r){this.context.loop(function(t,o,e){return coercePixel(r,t,o,e)})}),Martin.registerEffect("indicator",function(r){this.context.loop(function(r,t,o){return r>WIDTH&&(t/=HEIGHT-1,o.r=valFromY(t,0),o.g=valFromY(t,1/3),o.b=valFromY(t,2/3)),o})}),window.addEventListener("DOMContentLoaded",loadPicker);
//# sourceMappingURL=martin-colorpicker.min.js.map