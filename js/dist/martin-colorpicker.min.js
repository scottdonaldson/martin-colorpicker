function mouseup(){MOUSE_DOWN=!1}function mousedown(){MOUSE_DOWN=!0}function distance(r,t){var o=r[0]-t[0],a=r[1]-t[1];return Math.sqrt(o*o+a*a)}function xVal(r,t){return(255-r)*(1-INDICATOR_WIDTH/(WIDTH+INDICATOR_WIDTH)-t)+r}function yVal(r){return 255*r}function clamp(r,t,o){return r>o?o:t>r?t:r}function valFromY(r,t){var o=Math.cos(2*Math.PI*(r+t))+.5;return o=clamp(o,0,1),255*o}function coercePixel(r,t,o,a){return t/=WIDTH-1,a.r=xVal(r.r,t),a.g=xVal(r.g,t),a.b=xVal(r.b,t),o/=HEIGHT-1,a.r-=yVal(o),a.g-=yVal(o),a.b-=yVal(o),a.r=clamp(a.r,0,255),a.g=clamp(a.g,0,255),a.b=clamp(a.b,0,255),a}function makePicker(r){function t(r,t){for(;r.length<t;)r="0"+r;return r}var o=Martin();o.width(WIDTH+INDICATOR_WIDTH).height(HEIGHT),o.newLayer(),o.background("#fff");var a=o.colorpicker({r:255,g:0,b:0});o.indicator(),o.newLayer();var e=o.rect({color:"#666",x:WIDTH+1,y:1,height:4,width:INDICATOR_WIDTH-2,stroke:"#fff",strokeWidth:2}),n=o.circle({radius:4,color:"#666",stroke:"#fff",strokeWidth:2,x:WIDTH,y:0});return o.mousemove(function(o){var i,c,u=o.x,l=o.y;MOUSE_DOWN&&(u>WIDTH&&Math.abs(l-e.data.y-.5*e.data.height)<20?(l/=HEIGHT-1,i={r:valFromY(l,0),g:valFromY(l,1/3),b:valFromY(l,2/3)},e.data.y=o.y-2,a.data=i):WIDTH>=u&&(l/=HEIGHT-1,i={r:valFromY(l,0),g:valFromY(l,1/3),b:valFromY(l,2/3)},n.data.x=o.x,n.data.y=o.y),i&&(c=coercePixel(i,n.data.x,n.data.y,{}),c.r=t(Math.round(c.r).toString(16),2),c.g=t(Math.round(c.g).toString(16),2),c.b=t(Math.round(c.b).toString(16),2),r.value="#"+c.r.toString(16)+c.g.toString(16)+c.b.toString(16)))}),o.on("mousedown",mousedown),o.on("mouseup mouseout mouseleave",mouseup),o}function showPicker(r){var t=makePicker(r);r.parentNode.insertBefore(t.canvas,r)}function loadPicker(){var r=document.getElementsByTagName("input");[].forEach.call(r,function(r){"martin-colorpicker"===r.getAttribute("data-type")&&showPicker(r)})}var WIDTH=200,HEIGHT=200,INDICATOR_WIDTH=20,MOUSE_DOWN=!1;Martin.registerEffect("colorpicker",function(r){this.context.loop(function(t,o,a){return coercePixel(r,t,o,a)})}),Martin.registerEffect("indicator",function(r){this.context.loop(function(r,t,o){return r>WIDTH&&(t/=HEIGHT-1,o.r=valFromY(t,0),o.g=valFromY(t,1/3),o.b=valFromY(t,2/3)),o})}),window.addEventListener("DOMContentLoaded",loadPicker);
//# sourceMappingURL=martin-colorpicker.min.js.map